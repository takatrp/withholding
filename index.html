<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>受取利息・受取配当金 仕訳自動表示ツール</title>
<style>
  :root{
    --brand:#578899;
    --bg:#f7fbfd;
    --chip-on:#ffffff;
    --chip-off:#e6eef2;
  }
  html,body{margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP","Hiragino Kaku Gothic ProN","Yu Gothic",sans-serif;color:#222;background:var(--bg)}
  .wrap{max-width:720px;margin:0 auto;padding:16px 14px 28px}
  h1{font-size:18px;margin:2px 0 14px;color:#123;letter-spacing:.02em}
  .card{background:#fff;border:1px solid #dde6ea;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.03);padding:14px 12px;margin:10px 0}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:8px 0}
  .label{font-size:13px;color:#345;min-width:6.5em}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip input{display:none}
  .chip label{
    display:inline-block;padding:8px 12px;border-radius:999px;border:1px solid #c9d7de;
    background:var(--chip-off);cursor:pointer;font-size:14px;color:#123;user-select:none
  }
  .chip input:checked + label{
    background:var(--chip-on);border-color:var(--brand);box-shadow:0 0 0 2px rgba(87,136,153,.18) inset
  }
  .money{
    flex:1;min-width:150px;
    padding:10px 12px;font-size:16px;border:1px solid #c9d7de;border-radius:10px;background:#fff
  }
  .hint{font-size:12px;color:#567;margin-top:2px}
  .grid{display:grid;grid-template-columns:1fr auto;gap:8px 10px;margin-top:6px}
  .k{color:#456}
  .v{font-variant-numeric:tabular-nums;text-align:right}
  .strong{font-weight:700}
  .neg{color:#b50000}
  .btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  button{
    appearance:none;border:1px solid var(--brand);background:var(--brand);color:#fff;border-radius:10px;
    padding:10px 14px;font-size:14px;cursor:pointer
  }
  button.outline{background:#fff;color:var(--brand)}
  .jrnl{font-family:ui-monospace,Menlo,Consolas,"Noto Sans Mono CJK JP",monospace;font-size:14px;
        background:#fafcff;border:1px dashed #c9d7de;border-radius:10px;padding:10px 12px;white-space:pre-wrap}
  .footer{font-size:12px;color:#567;line-height:1.6}
  .brand{display:inline-block;padding:2px 8px;border-radius:6px;background:var(--brand);color:#fff;font-weight:700;margin-right:6px}
  .tag{display:inline-block;padding:2px 8px;border:1px solid #c9d7de;border-radius:6px;color:#345;background:#fff}
</style>
</head>
<body>
<div class="wrap">
  <h1><span class="brand">松本会計</span><span class="tag">r1</span> 受取利息・受取配当金｜入金額→仕訳 自動表示ツール</h1>

  <div class="card">
    <div class="row">
      <div class="label">対象</div>
      <div class="chips" id="entityChips">
        <div class="chip"><input type="radio" name="entity" id="ent_corp" value="corp" checked><label for="ent_corp">法人</label></div>
        <div class="chip"><input type="radio" name="entity" id="ent_sole" value="sole"><label for="ent_sole">個人事業主</label></div>
      </div>
    </div>

    <div class="row">
      <div class="label">種類</div>
      <div class="chips" id="typeChips">
        <div class="chip"><input type="radio" name="itype" id="t_interest" value="interest" checked><label for="t_interest">受取利息</label></div>
        <div class="chip"><input type="radio" name="itype" id="t_div" value="dividend"><label for="t_div">受取配当金</label></div>
      </div>
    </div>

    <div class="row" id="divSubRow" style="display:none">
      <div class="label">配当区分</div>
      <div class="chips" id="divKindChips">
        <div class="chip"><input type="radio" name="divkind" id="div_listed" value="listed" checked><label for="div_listed">上場株式等</label></div>
        <div class="chip"><input type="radio" name="divkind" id="div_unlisted" value="unlisted"><label for="div_unlisted">非上場等</label></div>
      </div>
    </div>

    <div class="row">
      <div class="label">入金額（手取）</div>
      <input class="money" id="net" inputmode="numeric" placeholder="例）64,000" />
    </div>
    <div class="hint">国内支払前提・源泉税は各税額1円未満切捨て。税率は自動適用（下段「根拠」参照）。</div>

    <div class="row">
      <div class="label">税率（自動）</div>
      <div class="grid" style="flex:1">
        <div class="k">所得税・復興特別所得税</div><div class="v" id="rNat">—</div>
        <div class="k">個人住民税（利子割／配当割）</div><div class="v" id="rLoc">—</div>
        <div class="k strong">合計源泉税率</div><div class="v strong" id="rTot">—</div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="grid">
      <div class="k">源泉前総額（計上額）</div><div class="v strong" id="gross">—</div>
      <div class="k">源泉所得税等（国税）</div><div class="v" id="taxNat">—</div>
      <div class="k">住民税（個人のみ）</div><div class="v" id="taxLoc">—</div>
      <div class="k">手取額（入金額）</div><div class="v" id="netOut">—</div>
    </div>
  </div>

  <div class="card">
    <div class="row" style="margin-top:0"><div class="label">仕訳（例）</div></div>
    <div class="jrnl" id="je">入金額を入力すると自動表示します。</div>
    <div class="btns">
      <button class="outline" id="copyBtn">仕訳をコピー</button>
      <button id="resetBtn">リセット</button>
    </div>
    <div class="hint">※法人は源泉所得税等を「仮払法人税等」（期末に法人税額から控除）。個人事業主は一般に「事業主貸」で処理します。</div>
  </div>

  <div class="card footer">
    <div style="font-weight:700;margin-bottom:6px">根拠（主な税率・取扱）</div>
    <ul>
      <li>配当の源泉徴収：上場株式等は15.315%（国税）＋個人は配当割5%／非上場等は20.42%（国税のみ）。復興特別所得税は令和19年（2037年）まで。出典：国税庁タックスアンサー No.1330。  [oai_citation:0‡国税庁](https://www.nta.go.jp/taxes/shiraberu/taxanswer/shotoku/1330.htm?utm_source=chatgpt.com)</li>
      <li>利子の源泉徴収：15.315%（国税）＋個人は利子割5%。出典：国税庁タックスアンサー No.1310。  [oai_citation:1‡国税庁](https://www.nta.go.jp/taxes/shiraberu/taxanswer/shotoku/1310.htm?utm_source=chatgpt.com)</li>
      <li>法人の利子割（地方税5%）は2016年1月1日以降 廃止。したがって法人の預金利息は国税15.315%のみ源泉。例示：東北銀行・お知らせ。  [oai_citation:2‡東北銀行](https://www.tohoku-bank.co.jp/personal/save/yen/info6.html?utm_source=chatgpt.com)</li>
      <li>配当割は個人課税であり、法人が受ける上場配当には配当割は課税されず、源泉は15.315%（国税）のみ。出典：東京都主税局。  [oai_citation:3‡東京都税務情報](https://www.tax.metro.tokyo.lg.jp/kazei/life/hi-kab?utm_source=chatgpt.com)</li>
      <li>会計処理の考え方（源泉分は期末に税額控除対象。「仮払法人税等」等で処理）：EY技術解説。  [oai_citation:4‡EY](https://www.ey.com/ja_jp/technical/corporate-accounting/qa/tax-effect/qa-tax-effect-uketori-rishi-haitou-gensen-syotokuzei?utm_source=chatgpt.com)</li>
    </ul>
  </div>
</div>

<script>
const fmt = n => isNaN(n) ? "—" : n.toLocaleString("ja-JP",{maximumFractionDigits:0});
const uncomma = s => (s||"").toString().replace(/[^\d]/g,"")*1;

const els = {
  net: document.getElementById('net'),
  rNat: document.getElementById('rNat'),
  rLoc: document.getElementById('rLoc'),
  rTot: document.getElementById('rTot'),
  gross: document.getElementById('gross'),
  taxNat: document.getElementById('taxNat'),
  taxLoc: document.getElementById('taxLoc'),
  netOut: document.getElementById('netOut'),
  je: document.getElementById('je'),
  copyBtn: document.getElementById('copyBtn'),
  resetBtn: document.getElementById('resetBtn'),
  divSubRow: document.getElementById('divSubRow'),
};

function getSel(name){ return document.querySelector(`input[name="${name}"]:checked`).value; }

function getRates(){
  const entity = getSel('entity'); // corp or sole
  const itype = getSel('itype');   // interest or dividend
  let rNat=0, rLoc=0, labelNat="", labelLoc="";
  if(itype==='interest'){
    rNat = 0.15315;
    rLoc = (entity==='sole') ? 0.05 : 0.0; // 個人のみ利子割
    labelNat = "15.315%";
    labelLoc = (entity==='sole') ? "5%" : "—";
  }else{
    const dkind = getSel('divkind'); // listed/unlisted
    if(dkind==='listed'){
      rNat = 0.15315;
      rLoc = (entity==='sole') ? 0.05 : 0.0; // 個人のみ配当割
      labelNat = "15.315%";
      labelLoc = (entity==='sole') ? "5%" : "—";
    }else{ // unlisted 等
      rNat = 0.2042;
      rLoc = 0.0; // 非上場は地方税なし（個人も）
      labelNat = "20.42%";
      labelLoc = "—";
    }
  }
  return {rNat, rLoc, labelNat, labelLoc};
}

// 逆算：税額は各々1円未満切捨てでネット一致する総額を探索
function reverseFromNet(net, rNat, rLoc){
  if(!(net>0)) return null;
  const rTot = rNat + rLoc;
  let g = Math.ceil(net / (1 - rTot));
  // 微調整
  for(let i=0;i<2000;i++){
    const tNat = Math.floor(g * rNat);
    const tLoc = Math.floor(g * rLoc);
    const calcNet = g - tNat - tLoc;
    if(calcNet === net){
      return {gross:g, tNat, tLoc, net:calcNet};
    }
    if(calcNet > net){ g--; } else { g++; }
  }
  // フォールバック
  const tNat = Math.floor(g * rNat);
  const tLoc = Math.floor(g * rLoc);
  return {gross:g, tNat, tLoc, net:g - tNat - tLoc};
}

function update(){
  // UI表示切替
  const itype = getSel('itype');
  els.divSubRow.style.display = (itype==='dividend') ? '' : 'none';

  // 整形入力
  const raw = uncomma(els.net.value);
  els.net.value = raw ? raw.toLocaleString("ja-JP") : "";

  const {rNat, rLoc, labelNat, labelLoc} = getRates();
  const rTot = rNat + rLoc;

  els.rNat.textContent = labelNat;
  els.rLoc.textContent = labelLoc;
  els.rTot.textContent = rTot ? (Math.round(rTot*100000)/1000).toFixed(3) + "%" : "—";

  if(!raw){ // クリア
    els.gross.textContent = "—";
    els.taxNat.textContent = "—";
    els.taxLoc.textContent = "—";
    els.netOut.textContent = "—";
    els.je.textContent = "入金額を入力すると自動表示します。";
    return;
  }

  const rev = reverseFromNet(raw, rNat, rLoc);
  if(!rev){ return; }

  els.gross.textContent = "¥"+fmt(rev.gross);
  els.taxNat.textContent = "¥"+fmt(rev.tNat);
  els.taxLoc.textContent = rLoc>0 ? ("¥"+fmt(rev.tLoc)) : "—";
  els.netOut.textContent = "¥"+fmt(rev.net);

  // 仕訳
  const entity = getSel('entity');
  const it = getSel('itype');
  const dkind = (it==='dividend') ? getSel('divkind') : "";
  const acctRev = (it==='interest') ? "受取利息" : "受取配当金";
  const acctTaxCorp = "仮払法人税等";
  const acctTaxSole = "事業主貸";
  const acctBank = "普通預金";

  let lines = [];
  lines.push(`【計算内訳】`);
  lines.push(`  源泉前総額 ${acctRev}: ¥${fmt(rev.gross)}`);
  lines.push(`  源泉所得税等（国税）: ¥${fmt(rev.tNat)}${rNat?`（税率 ${Math.round(rNat*100000)/1000}%）`:""}`);
  if(rLoc>0) lines.push(`  住民税（利子割/配当割）: ¥${fmt(rev.tLoc)}（税率 ${Math.round(rLoc*100000)/1000}%）`);
  lines.push(`  手取額（入金額）: ¥${fmt(rev.net)}`);
  lines.push("");
  lines.push(`【仕訳（例）】`);
  if(entity==='corp'){
    lines.push(`（借）${acctBank.padEnd(10,"　")} ¥${fmt(rev.net)}`);
    if(rev.tNat>0) lines.push(`（借）${acctTaxCorp.padEnd(10,"　")} ¥${fmt(rev.tNat)}`);
    if(rev.tLoc>0) lines.push(`（借）${acctTaxCorp.padEnd(10,"　")} ¥${fmt(rev.tLoc)}  ※個人住民税は法人には通常発生しません`);
    lines.push(`　　　（貸）${acctRev.padEnd(10,"　")} ¥${fmt(rev.gross)}`);
  }else{
    lines.push(`（借）${acctBank.padEnd(10,"　")} ¥${fmt(rev.net)}`);
    if(rev.tNat+rev.tLoc>0) lines.push(`（借）${acctTaxSole.padEnd(10,"　")} ¥${fmt(rev.tNat+rev.tLoc)}`);
    lines.push(`　　　（貸）${acctRev.padEnd(10,"　")} ¥${fmt(rev.gross)}`);
  }
  lines.push("");
  if(it==='dividend'){
    lines.push(`※税務：法人の受取配当金は株式区分・保有割合等により「益金不算入」の取扱いあり（別途、法人税計算で対応）。`);
  }else{
    lines.push(`※メモ：法人の預金利息は2016/1/1以後、地方税（利子割）なし。`);
  }
  els.je.textContent = lines.join("\n");
}

document.querySelectorAll('input[name="entity"],input[name="itype"],input[name="divkind"]').forEach(el=>{
  el.addEventListener('change', update);
});
els.net.addEventListener('input', update);

// 初期
update();

els.copyBtn.addEventListener('click', async ()=>{
  try{
    await navigator.clipboard.writeText(els.je.textContent);
    els.copyBtn.textContent = "コピーしました";
    setTimeout(()=>els.copyBtn.textContent="仕訳をコピー",1200);
  }catch(e){
    alert("コピーに失敗しました。");
  }
});
els.resetBtn.addEventListener('click', ()=>{
  document.getElementById('ent_corp').checked = true;
  document.getElementById('t_interest').checked = true;
  document.getElementById('div_listed').checked = true;
  els.net.value = "";
  update();
});
</script>
</body>
</html>
